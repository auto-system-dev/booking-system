# 平日假日價格設定方案

## 📋 方案說明

本系統採用**方案B：假日設定表**的方式來實現平日和假日價格。

### 核心概念

1. **房型表結構**：
   - `price`：平日價格（基礎價格）
   - `holiday_surcharge`：假日加價（可為正數或負數）

2. **假日日期表**：
   - 可手動新增特定日期為假日
   - 支援連續假期（可設定日期範圍）
   - 自動判斷週六、週日為假日

3. **價格計算邏輯**：
   - 平日：使用 `price`
   - 假日：使用 `price + holiday_surcharge`
   - 跨平日和假日的訂房：分別計算每日價格後加總

## 🗂️ 資料庫結構

### 1. 房型表（room_types）新增欄位

```sql
ALTER TABLE room_types ADD COLUMN holiday_surcharge INTEGER DEFAULT 0;
```

### 2. 假日日期表（holidays）

```sql
CREATE TABLE IF NOT EXISTS holidays (
    id SERIAL PRIMARY KEY,
    holiday_date DATE NOT NULL UNIQUE,
    holiday_name VARCHAR(255),
    is_weekend INTEGER DEFAULT 0,  -- 0: 手動新增, 1: 自動判斷週末
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## 💡 使用方式

### 1. 設定房型價格

在「房型管理」中：
- **平日價格**：設定基礎價格（例如：NT$ 2,000）
- **假日加價**：設定假日加價金額（例如：NT$ 500）
  - 正數：假日價格 = 平日價格 + 加價
  - 負數：假日價格 = 平日價格 - 減價
  - 0：假日價格 = 平日價格

### 2. 管理假日日期

在「系統設定」→「假日管理」中：
- **新增假日**：選擇日期並輸入假日名稱（例如：2025-01-01 元旦）
- **新增連續假期**：選擇開始和結束日期
- **自動週末**：系統自動判斷週六、週日為假日（可開關）

### 3. 價格計算範例

**範例 1：單一日期**
- 平日價格：NT$ 2,000
- 假日加價：NT$ 500
- 訂房日期：2025-12-13（週六）
- 計算結果：NT$ 2,000 + NT$ 500 = NT$ 2,500

**範例 2：跨平日和假日**
- 平日價格：NT$ 2,000
- 假日加價：NT$ 500
- 訂房日期：2025-12-12（週五）～ 2025-12-14（週日）
- 計算結果：
  - 12/12（週五，平日）：NT$ 2,000
  - 12/13（週六，假日）：NT$ 2,500
  - 12/14（週日，假日）：NT$ 2,500
  - 總計：NT$ 7,000

## 🔧 實作步驟

### 步驟 1：資料庫遷移
- 在房型表添加 `holiday_surcharge` 欄位
- 建立假日日期表

### 步驟 2：後端 API
- 新增假日管理 API（新增、刪除、查詢）
- 修改價格計算邏輯，判斷日期是否為假日

### 步驟 3：前端介面
- 在房型編輯表單中添加「假日加價」欄位
- 在系統設定中添加「假日管理」區塊
- 修改價格計算函數，支援平日/假日價格

### 步驟 4：價格顯示
- 在前台顯示房型價格時，顯示「平日價格」和「假日價格」
- 在訂房表單中，根據選擇的日期動態計算總價

## 📝 注意事項

1. **假日判斷優先順序**：
   - 手動新增的假日 > 自動判斷的週末
   - 如果某個日期同時是手動假日和週末，以手動假日為準

2. **價格計算時機**：
   - 前台選擇日期時，即時計算並顯示價格
   - 提交訂房時，再次計算確認價格

3. **向後相容**：
   - 現有房型的 `holiday_surcharge` 預設為 0（假日價格 = 平日價格）
   - 現有訂房記錄不受影響

## 🎯 未來擴充

1. **特殊日期價格**：可為特定日期設定特殊價格（例如：跨年、春節）
2. **淡旺季設定**：可設定淡季和旺季的價格差異
3. **連續住宿優惠**：可設定連續住宿多晚的折扣

